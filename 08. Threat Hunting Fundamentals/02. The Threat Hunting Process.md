---
title: 02. The Threat Hunting Process
updated: 2025-08-18 05:08:20Z
created: 2025-08-18 04:02:47Z
---

## **The Threat Hunting Process**

Threat hunting is a **structured, repeatable cycle**. Each phase builds on the last, ensuring that we move from preparation to action to continuous improvement.

In short: **Threat hunting = prepare → hypothesize → plan → hunt → confirm → respond → document → improve.**

### 1\. Setting the Stage (Preparation)

Before hunting starts, we get the environment ready. This means:

- Identifying critical systems and data we need to protect.
    
- Enabling detailed logging across servers, endpoints, and network devices.
    
- Making sure tools like **SIEM, EDR, IDS/IPS** are collecting and correlating data.
    
- Staying updated on the latest **threat intelligence and attacker profiles**.
    

**Example:** The team reviews recent reports on ransomware targeting their industry. They configure SIEM to collect Windows Event Logs, set up EDR agents on critical endpoints, and ensure firewall logs are stored for analysis. They also join an information-sharing group to keep updated on attacker TTPs

* * *

### 2\. Formulating Hypotheses

We form **educated guesses** about how an attacker might be operating in our environment. These must be specific and testable.

- Hypotheses can come from alerts, threat intel, or attacker TTPs.
    
- They guide where and what we investigate.
    

**Example:** Based on alerts and recent intelligence, the team hypothesizes: *“Attackers may be using phishing emails with malicious attachments to compromise employee accounts and establish persistence.”*

* * *

### 3\. Designing the Hunt

Now we build a **plan to test the hypothesis**:

- Decide which logs/data sources to analyze (DNS, web server logs, EDR telemetry, etc.).
    
- Define queries, detection rules, and filters.
    
- Use IoCs (file hashes, domains, IPs) from intel feeds.
    
- Write custom scripts or automation where needed.
    

**Example:** The team decides to check:

- Email server logs for unusual attachments.
    
- Endpoint telemetry for macro executions.
    
- DNS logs for connections to suspicious domains.  
    They also pull IoCs (file hashes and IPs) from threat intel feeds and prepare queries to search them across logs.
    

* * *

### 4\. Data Gathering & Examination

This is the **active hunting phase**:

- Collect logs, traffic captures, and endpoint telemetry.
    
- Analyze them using statistical, behavioral, or signature-based techniques.
    
- Look for anomalies that support or disprove the hypothesis.
    

**Example:**

- They review email logs and notice repeated delivery of Word documents with macros.
    
- They inspect firewall logs and spot outbound traffic to IPs listed in a threat feed.
    
- They analyze endpoint logs and find processes spawning PowerShell from Word — a strong infection indicator.
    

* * *

### 5\. Evaluating Findings

We **decide what the evidence means**:

- Confirm or reject the hypothesis.
    
- Identify which systems are affected.
    
- Assess how severe the threat is.
    

**Example:** The evidence shows some employees received phishing emails, one endpoint executed the malicious attachment, and it later reached out to a known C2 domain. This confirms the phishing → malware → C2 hypothesis.

* * *

### 6\. Mitigating Threats

If a threat is confirmed, we act:

- Isolate compromised systems.
    
- Remove malware and block malicious domains.
    
- Patch vulnerabilities and adjust configs to close gaps.
    

**Example:**

- The infected endpoint is isolated from the network.
    
- Malware is removed with an EDR cleanup function.
    
- The compromised email account is reset with MFA enforced.
    
- Firewall rules are updated to block the attacker’s C2 domains.
    

* * *

### 7\. After the Hunt (Documentation & Sharing)

Once the hunt ends, we **record and share what we found**:

- Document IoCs, TTPs, and methods used.
    
- Update SIEM rules and incident response playbooks.
    
- Share intel internally and with trusted partners.
    

**Example:** The team updates SIEM with new detection rules for suspicious Word macros, publishes discovered IoCs into the company’s threat intel platform, and refines the phishing response playbook. They also share insights with peer organizations through their industry ISAC.

* * *

### 8\. Continuous Learning & Enhancement

Threat hunting is never “done.” Each cycle feeds the next.

- Review what worked and what didn’t.
    
- Update tools, hypotheses, and methods.
    
- Learn from new campaigns and adapt.
    

**Example:** The team realizes attackers used domain-generated algorithms (DGAs) for C2. For the next hunt, they add anomaly detection for unusual DNS requests. They also send analysts to training on malware traffic analysis to sharpen detection skills.

* * *

## **Applying This to ==Emotet==**

==Emotet== is an ==advanced Trojan== primarily spread via phishing email attachments and links that, once clicked, launch the payload. The malware then attempts to proliferate within a network by brute forcing user credentials and writing to shared drives 

Emotet is difficult to combat because of its “worm-like” features that enable network-wide infections. Additionally, Emotet uses modular Dynamic Link Libraries to continuously evolve and update its capabilities.

Since July 2020, CISA has seen increased activity involving Emotet-associated indicators. During that time, CISA’s EINSTEIN Intrusion Detection System, which protects federal, civilian executive branch networks, has detected roughly 16,000 alerts related to Emotet activity. CISA observed Emotet being executed in phases during possible targeted campaigns. Emotet used compromised Word documents (.doc) attached to phishing emails as initial insertion vectors. 

Traffic to known Emotet-related domains or IPs occurred most commonly over ports 80, 8080, and 443. In one instance, traffic from an Emotet-related IP attempted to connect to a suspected compromised site over port 445, possibly indicating the use of Server Message Block exploitation frameworks along with Emotet (*Exploitation of Remote Services* 

Using the process above against ==**Emotet malware**== looks like this:

1.  **Setting the Stage (Preparation)**
    
    - Research Emotet’s behavior: spreading via phishing emails with malicious Word/Excel attachments, links, and software vulnerabilities.
        
    - Identify likely targets: endpoints with admin rights, email servers, and high-value systems.
        
    - Gather intelligence from reports, malware samples, and past incidents.
        
2.  **Formulating Hypotheses**
    
    - Create testable statements based on known Emotet activity.
        
    - Example: *“Emotet may be using compromised internal email accounts to send phishing emails with malicious macros.”*
        
    - Hypotheses can come from recent threat intel or suspicious email security alerts.
        
3.  **Designing the Hunt**
    
    - Decide what logs and data to use:  
        • Email server logs (suspicious attachments, subject lines).  
        • Network traffic (connections to C2 servers).  
        • Endpoint logs or sandbox analysis (file execution behavior).
        
    - Use IoCs (hashes, domains, IPs) and TTPs to build queries and filters.
        
4.  **Data Gathering and Examination**
    
    - Collect evidence across multiple sources:  
        • Check email logs for unusual attachments or repetitive phishing attempts.  
        • Analyze PCAPs for traffic to Emotet’s known C2 IPs.  
        • Use sandboxing to see what suspicious attachments do.
        
    - Apply techniques like header analysis, network traffic analysis, or malware behavior profiling.
        
5.  **Evaluating Findings and Testing Hypotheses**
    
    - Confirm or reject the hypotheses with evidence:  
        • Multiple phishing emails with similar attachment types? → Supports hypothesis.  
        • Network activity to Emotet C2 servers? → Indicates active compromise.
        
    - If confirmed, assess scope: which systems are infected, what data is at risk.
        
6.  **Mitigating Threats**
    
    - Contain: isolate infected machines to stop spread.
        
    - Eradicate: run endpoint protection or specialized Emotet removal tools.
        
    - Recover: reset compromised email accounts, patch vulnerabilities, block malicious IPs/domains.
        
7.  **After the Hunt (Documentation & Knowledge Sharing)**
    
    - Record methods, findings, and results.
        
    - Update IoC feeds and SIEM rules with new detections.
        
    - Share lessons with internal teams and external partners.
        
    - Improve playbooks for faster handling next time.
        
8.  **Continuous Learning and Enhancement**
    
    - Review what worked and what didn’t.
        
    - Stay updated on Emotet’s evolving TTPs (since it constantly changes).
        
    - Incorporate new detection methods (like behavioral or ML-based detection).
        
    - Join communities, attend training, and refine hunting skills continuously.
        

&nbsp;