---
title: 10. ARP Scanning & Anomalies Detection
updated: 2025-09-13 16:13:12Z
created: 2025-09-13 16:08:31Z
---

# ARP Spoofing & Abnormality Detection – Summary Notes

## 1\. Normal ARP Operation

- ARP resolves **IP → MAC address mappings** inside a LAN.
    
- Process:
    
    1.  Host checks ARP cache.
        
    2.  If missing, it broadcasts: *“Who has IP X?”*.
        
    3.  The target replies: *“IP X is at MAC Y”*.
        
    4.  Cache updates → communication continues.
        
- Each IP should always map to only **one MAC address**.
    

* * *

## 2\. ARP Spoofing / Poisoning Attack

- ARP has **no authentication**, so attackers can send **forged ARP replies**.
    
- Attacker poisons ARP caches on both sides:
    
    - To **victim**:
- `192.168.10.1 (router) is at attacker’s MAC`
    
    → Victim sends all traffic meant for router to attacker.
    
- To **router**:
    
    - `192.168.10.4 (victim) is at attacker’s MAC`
        
        ```
        → Router sends all traffic meant for victim to attacker.
        ```
        
- Result: **Attacker sits in the middle**:
    
- `Victim ↔ Attacker ↔ Router`
    
- If attacker **drops traffic** → DoS.
    
- If attacker **forwards traffic** → MITM (can sniff/modify packets).
    

* * *

## 3\. Identifying ARP Spoofing in Captures

### Key Red Flags in Wireshark

- **Duplicate IP warnings** (same IP → two different MACs).
    
- **Unsolicited ARP replies** (without matching requests).
    
- **One MAC claiming multiple IPs**.
    
- **Frequent ARP broadcasts** from a single host.
    
- **TCP resets / retransmissions** → attacker not forwarding traffic.
    
- **Symmetrical traffic patterns** (if forwarding, attacker relays both ways).
    

### Useful Filters

- `arp.opcode == 1` → ARP requests.
    
- `arp.opcode == 2` → ARP replies.
    
- `arp.duplicate-address-detected` → Wireshark detects IP conflicts.
    
- `eth.addr == <MAC>` → Track specific devices.
    

* * *

## 4\. Behavior Seen in Example Scenarios

- Attacker (`08:00:27:53:0c:ba`) repeatedly broadcasted ARP traffic.
    
- Victim was `192.168.10.4` (real MAC `50:eb:f6:ec:0e:7f`).
    
- Router/gateway was `192.168.10.1` (MAC `2c:30:33:e2:d5:c3`).
    
- **Conflict:** Victim’s IP (`.4`) claimed by both the legitimate MAC and attacker’s MAC.
    
- TCP sessions showed **RSTs, FINs, and retransmissions** → sessions breaking → indicates DoS rather than stealth MITM.
    

* * *

## 5\. Forged ARP Replies (What They Look Like)

- Legitimate reply from router:
    
- `192.168.10.1 is at 2c:30:33:e2:d5:c3`
    
- Forged reply from attacker:
    
- `192.168.10.1 is at 08:00:27:53:0c:ba`
    
- Same structure, but **wrong MAC mapping**.
    
- Hosts blindly trust the latest ARP reply → caches get poisoned.
    

* * *

## 6\. ARP Table Changes (Before vs After Poisoning)

| Device | Normal ARP Cache | After Poisoning |
| --- | --- | --- |
| Victim | `192.168.10.1 → 2c:30:33:e2:d5:c3` | `192.168.10.1 → 08:00:27:53:0c:ba` |
| Router | `192.168.10.4 → 50:eb:f6:ec:0e:7f` | `192.168.10.4 → 08:00:27:53:0c:ba` |
| Attacker | Learns all real IP ↔ MAC from ARP scans | Keeps real table for forwarding |

* * *

## 7\. Why Victim Talks to Attacker

- The victim **doesn’t choose to**.
    
- Its ARP cache is poisoned to believe the router’s IP maps to the attacker’s MAC.
    
- Ethernet frames go to the attacker automatically.
    
- Same for the router in the opposite direction.
    

* * *

## 8\. Attacker Strategy

- Often floods the network with “Who has X?” to learn all MACs (network mapping).
    
- Sends forged replies to overwrite ARP caches.
    
- Can scale beyond one victim → poison multiple hosts and the router, putting the attacker in the path of the **entire subnet’s traffic**.
    

* * *

## 9\. Mitigations

- **Static ARP entries** → prevents cache overwrites (but hard to maintain).
    
- **Switch security (Port Security, Dynamic ARP Inspection)** → blocks spoofed ARP.
    
- **IDS/IPS rules (Snort, Suricata)** → detect anomalies in ARP traffic.
    
- **Monitoring tools (arpwatch, Wireshark alerts)** → alert on duplicate IPs or unsolicited replies.
    

* * *

ARP spoofing works because ARP is a **trust-based, unauthenticated protocol**. By forging replies, attackers trick both victim and router into updating their caches incorrectly. This allows the attacker to intercept, modify, or drop packets. Detection hinges on spotting **duplicate IPs, unsolicited replies, and abnormal traffic patterns**.

* * *

&nbsp;