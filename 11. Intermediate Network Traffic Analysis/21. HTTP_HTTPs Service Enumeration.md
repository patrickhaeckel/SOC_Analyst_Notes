---
title: 21. HTTP/HTTPs Service Enumeration
updated: 2025-09-17 04:05:40Z
created: 2025-09-17 04:03:08Z
---

# HTTP/HTTPS Service Enumeration & Fuzzing Detection

**PCAP Reference**: `basic_fuzzing.pcapng`

Web servers often become the target of unusual or excessive HTTP/HTTPS traffic. In many cases, attackers attempt to **fuzz** web applications — sending large numbers of automated requests in order to discover hidden directories, files, or parameters that may expose vulnerabilities.

As defenders, recognizing these behaviors in packet captures and server logs is essential for early detection and response.

* * *

## Recognizing Fuzzing Attempts

Indicators of fuzzing activity often include:

- **High-volume requests** from a single host.
    
- **Repeated attempts** to access non-existent files (many HTTP 404 responses).
    
- **Rapid request bursts** or evenly staggered requests to avoid detection.
    
- **Suspicious user-agents** (outdated browsers, generic scanners, or missing headers).
    

You can spot this in two main places:

1.  **Network captures** (e.g., filtering `http` or `http.request` traffic in Wireshark).
    
2.  **Web server access logs** (e.g., Apache or Nginx logs).
    

* * *

## Directory Fuzzing in Practice

Attackers use tools like **DirBuster**, **Gobuster**, or **FFUF** to brute-force hidden files and directories.

In Wireshark: `http`

This filter shows all HTTP traffic. To isolate **only requests**, remove server responses: `http.request`

### Example Behavior:

- Source: `192.168.10.5`
    
- Destination: `192.168.10.1`
    
- Requests include attempts to access `.bash_history`, `.git/HEAD`, `.config`, and random filenames.
    

Most return **404 Not Found**, which is a red flag for directory fuzzing.

* * *

## Correlating with Server Logs

Attackers leave traces in access logs. For Apache:

### Using `grep`:

`cat access.log | grep "192.168.10.5"`

### Using `awk`:

`cat access.log | awk '$1 == "192.168.10.5"'`

Both commands extract suspicious requests from the identified host. You may see requests like:

```bash
192.168.10.5 - - [18/Jul/2023:12:58:07 -0600] "GET /.bash_history HTTP/1.1" 404 435 "-" "Mozilla/4.0..."
192.168.10.5 - - [18/Jul/2023:12:58:07 -0600] "GET /.git/HEAD HTTP/1.1" 404 435 "-" "Mozilla/4.0..."

```

Such patterns strongly suggest fuzzing activity.

* * *

## Beyond Directory Fuzzing

Attackers may also fuzz:

- **Dynamic parameters** (e.g., incrementing `id=1, id=2, id=3`).
    
- **JSON/API fields** (e.g., altering `return=max` → `return=min`).
    
- **IDOR checks** (Insecure Direct Object References) by requesting resources they shouldn’t access.
    

In Wireshark, you can focus on a suspected host with:

`http.request and ((ip.src_host == <IP>) or (ip.dst_host == <IP>))`

Then right-click → **Follow → HTTP Stream** to reconstruct entire conversations.

* * *

## Evasion Tactics Used by Attackers

To avoid easy detection, attackers may:

- Spread requests over longer intervals.
    
- Rotate source IP addresses or use botnets.
    

This makes **log correlation** and **traffic baselining** even more important.

* * *

## Mitigation & Prevention

Defenders can reduce fuzzing success with:

- **Proper response codes**: Configure servers to avoid leaking information (e.g., consistent 403/404 handling).
    
- **Web Application Firewalls (WAFs)**: Block high-frequency requests or known malicious patterns.
    
- **Rate limiting / throttling**: Restrict the number of requests per IP.
    
- **IP blocking**: Temporarily ban abusive hosts.
    

* * *

**Key Takeaway**:  
By combining **packet capture analysis (Wireshark filters)** with **log correlation (grep/awk)**, you can quickly spot directory fuzzing and other enumeration attempts before they escalate into actual exploitation.

* * *

&nbsp;