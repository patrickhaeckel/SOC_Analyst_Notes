---
title: 26. Strange Telnet & UDP Connections
updated: 2025-09-20 02:09:25Z
created: 2025-09-20 02:07:45Z
---

# Strange Telnet & UDP Connections: Deep Dive

When investigating suspicious traffic, two protocols that often go overlooked are **Telnet** and **UDP**. Both can be abused by attackers for command and control (C2), data exfiltration, or tunneling. Below, I’ll walk through how to recognize, analyze, and interpret such traffic.

* * *

## 1\. Telnet: Overview and Security Concerns

- **What it is**: Telnet (RFC 854, created in the 1970s) enables remote text-based communication between two machines. It establishes a **bidirectional, interactive session**.
    
- **Why it’s risky**:
    
    - Sends all data (including usernames and passwords) **in plaintext**.
        
    - Rarely used legitimately today (replaced by SSH), so its presence is usually **a red flag**.
        
    - Attackers may use it to **control old systems** or **tunnel data** across the network.
        

**Red Flag Indicators of Malicious Telnet**:

- Telnet running on unexpected ports.
    
- Telnet over IPv6 (especially if your network doesn’t normally use IPv6).
    
- Telnet traffic with non-standard payloads (data that looks like encoded/hidden messages).
    

* * *

## 2\. Finding Traditional Telnet Traffic (Port 23)

- **Default Port**: Telnet normally uses **TCP port 23**.
    
- **Analysis Tip**: In Wireshark, apply this filter to see Telnet sessions:
    
- `tcp.port == 23`
    
- **What to Look For**:
    
    - **Session initiation**: You’ll see TCP handshakes followed by plaintext commands.
        
    - **Commands & responses**: Since Telnet is unencrypted, you can literally read what’s typed (e.g., `dir`, `ls`, or even attacker messages).
        
    - **Signs of tunneling**: Data that doesn’t look like normal command output (e.g., base64 blobs, structured patterns).
        

* * *

## 3\. Telnet on Non-Standard Ports

Attackers often move Telnet to other ports to **avoid detection**. For example, port **9999** instead of 23.

- **Detection Method**: Look for unusual amounts of TCP traffic to a port that normally isn’t used.
    
- **Analysis Tip**: Even without knowing it’s Telnet, Wireshark can show you ASCII data in streams. If you see Telnet negotiation commands or human-readable text like “telnet!!!” — that’s a giveaway.
    
- **Filter for suspicious ports**:
    
- `tcp.port == 9999`
    
- **Action**: Follow the TCP stream in Wireshark to reconstruct the conversation. This can reveal stolen data or attacker “notes.”
    

* * *

## 4\. Telnet over IPv6

Even trickier, attackers may use Telnet over **IPv6**.

- **Why suspicious**: Many enterprise environments don’t actively use IPv6. If you see IPv6 Telnet, it’s worth digging into.
    
- **Filter for IPv6 Telnet from/to a specific host**:
    
- `((ipv6.src == fe80::c9c8:ed3:1b10:f10b) or (ipv6.dst == fe80::c9c8:ed3:1b10:f10b)) and telnet`
    
- **Analysis Tip**:
    
    - Look for ICMPv6 neighbor solicitation/advertisement around the Telnet traffic (attackers may probe the IPv6 network first).
        
    - As with IPv4 Telnet, follow the TCP stream to inspect messages.
        

* * *

## 5\. UDP: Why Attackers Use It

Unlike TCP, **UDP is connectionless**.

- **Advantages for attackers**:
    
    - Faster transmission (no handshake overhead).
        
    - Easier to sneak by security tools that focus on TCP.
        
    - Can be used for covert channels.
        
- **How to spot it**:
    
    - Consistent traffic between two hosts on unusual ports.
        
    - Regular packet sizes (attackers often chunk data).
        
    - Payloads that look like encoded data instead of normal application traffic.
        

**Filter in Wireshark**:

`udp and ip.addr == 192.168.10.7`

* * *

## 6\. Following UDP in Wireshark

- Unlike TCP, there’s no “stream” concept, but Wireshark can reassemble UDP conversations.
    
- Look for:
    
    - **Readable ASCII** (attackers may send test messages).
        
    - **Obvious encoding** (Base64 strings, hex dumps, or repeating patterns).
        
    - **Suspicious messages** about exfiltration, testing, or C2 commands.
        

* * *

## 7\. Legitimate Uses of UDP (to Avoid False Positives)

Not all UDP is malicious. Here are common legit services:

| Protocol | Purpose |
| --- | --- |
| **DNS** | Resolves domain names (UDP/53) |
| **DHCP** | Assigns IP addresses (UDP/67,68) |
| **SNMP** | Network management (UDP/161,162) |
| **TFTP** | Simple file transfers (UDP/69, often on legacy systems) |
| **VoIP / Gaming / Streaming** | Real-time traffic (varies by port) |

When analyzing, check **if the port matches the expected service**. DNS on port 53? Probably fine. DNS-like traffic on port 4444? Suspicious.

* * *

## 8\. Key Takeaways for Analysts

1.  **Telnet** is outdated and insecure — monitor both port 23 and unusual ports.
    
2.  **IPv6 traffic** should be flagged if your environment doesn’t normally use it.
    
3.  **UDP** is harder to track, so attackers love it — look for unusual ports, consistent payloads, or encoding.
    
4.  **Follow streams** in Wireshark to reconstruct possible malicious actions.
    
5.  **Baseline normal traffic** for your network — this makes anomalies stand out.
    

* * *

&nbsp;