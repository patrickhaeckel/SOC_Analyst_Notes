---
title: 18. TCP Handshake Abnormalities
updated: 2025-09-15 05:15:26Z
created: 2025-09-15 02:45:01Z
---

# TCP Handshake Abnormalities (Scanning Techniques)

Abnormal TCP scans work by **abusing TCP flags and the handshake process** to probe targets without completing normal connections. The goal is stealth, firewall mapping, or evasion of intrusion detection. Unlike application-layer attacks, these are purely **transport-layer (TCP) manipulations**.

* * *

## 1\. SYN Scan (Half-Open Scan)

**How it works**

- Attacker sends SYN packets to multiple ports.
    
- If port is **open** → target replies with SYN/ACK → attacker immediately resets with RST (never finishes handshake).
    
- If port is **closed** → target replies with RST.
    

**Example**

- Attacker: 192.168.10.100
    
- Target: 192.168.10.1
    
- Flow to open port 80: SYN → SYN/ACK → RST
    
- Flow to closed port 23: SYN → RST
    

**Detection**

- Large volume of SYN packets without matching full connections.
    
- Frequent SYN/ACK followed immediately by RST.
    
- High ratio of **SYNs to completed handshakes**.
    

**Difference vs Others**

- Pure reconnaissance, fast, very common (default Nmap scan).
    
- Differs from NULL/FIN/Xmas scans since it **does attempt a handshake**.
    

* * *

## 2\. SYN Stealth Scan (Half-Handshake)

**How it works**

- Same as SYN scan, but attacker **never replies to SYN/ACK** at all.
    
- Leaves the connection hanging (“half-open”).
    

**Example**

- Attacker: 192.168.10.100
    
- Target: 192.168.10.1
    
- Flow to open port 443: SYN → SYN/ACK → *no response*.
    

**Detection**

- Many SYN/ACK packets with no follow-up ACK.
    
- Spikes in half-open connections in firewall/IDS logs.
    

**Difference vs Others**

- Even stealthier than SYN scan — no RST sent back.
    
- Looks like a network issue, unless seen in volume.
    

* * *

## 3\. NULL Scan

**How it works**

- Attacker sends TCP packets with **no flags set**.
    
- Open ports → ignore the probe.
    
- Closed ports → send back RST.
    

**Example**

- Attacker: 192.168.10.100 → Target: 192.168.10.1
    
- Probe to port 21 (open): no response.
    
- Probe to port 22 (closed): RST returned.
    

**Detection**

- TCP packets in Wireshark with **Flags = 0x000**.
    
- Repeated no-flag traffic to many ports.
    

**Difference vs Others**

- Belongs to the same family as FIN and Xmas scans.
    
- Relies on **silence vs. RST** to map ports.
    

* * *

## 4\. ACK Scan

**How it works**

- Attacker sends TCP ACK probes.
    
- Used for **firewall mapping**, not port discovery.
    
- If firewall allows packet through → host sends RST.
    
- If firewall blocks → no response.
    

**Example**

- Attacker: 192.168.10.100 → Target: 192.168.10.1
    
- ACK sent to port 80 → RST received (not filtered).
    
- ACK sent to port 25 → no response (filtered).
    

**Detection**

- Large streams of ACKs with no prior SYN handshakes.
    
- Unexpected RSTs triggered from closed ports.
    

**Difference vs Others**

- Unlike SYN/NULL/FIN/Xmas, it **doesn’t reveal open/closed ports**.
    
- Focused on identifying firewall rules.
    

* * *

## 5\. FIN Scan

**How it works**

- Attacker sends TCP segments with only the **FIN flag**.
    
- Open ports ignore the probe.
    
- Closed ports send back RST.
    

**Example**

- Attacker: 192.168.10.100 → Target: 192.168.10.1
    
- Probe to port 110 (open): no response.
    
- Probe to port 25 (closed): RST returned.
    

**Detection**

- FIN packets without any previous SYNs.
    
- RST responses to unexpected FINs.
    

**Difference vs Others**

- Behaves like NULL and Xmas scans.
    
- Uses a **single “end connection” flag** as the trick.
    

* * *

## 6\. Xmas Scan (Christmas Tree Scan)

**How it works**

- Attacker sends TCP packets with **FIN + PSH + URG set**.
    
- Open ports ignore or occasionally send RST.
    
- Closed ports reply with RST.
    

**Example**

- Attacker: 192.168.10.100 → Target: 192.168.10.1
    
- Probe to port 143 (open): silence.
    
- Probe to port 53 (closed): RST returned.
    

**Detection**

- Packets in Wireshark with multiple unusual flags lit up.
    
- Easy to spot since normal traffic rarely uses this combo.
    

**Difference vs Others**

- Same family as NULL and FIN scans.
    
- Nickname comes from “lighting up” multiple flags like a Christmas tree.
    

* * *

# Similarities Between Scan Types

| Family | Members | Open Port Response | Closed Port Response | Purpose |
| --- | --- | --- | --- | --- |
| **SYN-based** | SYN, SYN Stealth | SYN/ACK (then RST or none) | RST | Direct port discovery, half-open connections |
| **Flag-based** | NULL, FIN, Xmas | Silence | RST | Stealth port discovery |
| **ACK-based** | ACK | RST / silence | RST | Firewall rule mapping |

* * *

**Key takeaway**:

- **SYN family**: noisy, faster, but easy to catch via incomplete handshakes.
    
- **NULL/FIN/Xmas family**: stealthier, exploit RFC quirks, rely on silence vs. reset.
    
- **ACK scan**: doesn’t show open ports, but maps firewall filtering.
    

* * *

&nbsp;