---
title: 15. IP Src & Dest Spoofing Attacks
updated: 2025-09-15 01:45:45Z
created: 2025-09-13 22:12:53Z
---

# IP Source & Destination Spoofing Attacks

Spoofing at the **IP layer** means forging the source and/or destination IP fields in an IP packet header. Attackers do this to **hide their identity**, **evade detection**, or **amplify traffic** against a victim. Unlike ARP poisoning (layer 2), these are purely **layer 3 attacks (IP layer)**.

* * *

## 1\. Decoy Scanning

**How it works**

- Attacker sends probes (e.g., Nmap scans) but forges the **source IP** to make it appear as if traffic is coming from another host.
    
- Target may trust the spoofed source (since it’s in the same subnet) and allow traffic.
    
- Meanwhile, the attacker gets **some responses back directly**, revealing open ports.
    

**Example**

- Attacker IP: `192.168.10.100`
    
- Spoofed IP: `192.168.10.5` (legit subnet host)
    
- Target: `192.168.10.1`
    
- Target sees requests from `.5`, not `.100`.
    
- Firewall rules based on subnet trust may be bypassed.
    

**Detection**

- Odd packet fragmentation (crafted probes).
    
- Connection started by one host, then responses directed elsewhere.
    
- Multiple RSTs from closed ports still reach the real attacker.
    

**Difference vs Others**

- Decoy scanning is **reconnaissance**, not DoS.
    
- Differs from Smurf/LAND because it’s stealth-focused, not about resource exhaustion.
    

* * *

## 2\. Random Source Attack (DoS/DDoS)

**How it works**

- Attacker sends a flood of packets to a victim, but spoofs **random source IPs**.
    
- Victim sees connections from thousands of different addresses.
    
- Hard to filter since traffic looks distributed.
    
- Usually targets a **single port/service** (e.g., TCP/80).
    

**Example**

- Target: `192.168.10.1:80`
    
- Packets come from fake IPs like `23.45.67.89`, `111.43.91.100`, etc.
    
- All SYN packets appear valid but clog resources.
    

**Indicators**

- Same port targeted (low entropy).
    
- Base ports increment sequentially (not random like normal traffic).
    
- Identical packet length fields.
    

**Difference vs Others**

- Unlike Smurf (reflection), here the victim directly receives all the bogus traffic.
    
- Unlike LAND, spoofed IPs are random, not the same as the target.
    

* * *

## 3\. LAND Attack

**How it works**

- Attacker spoofs the **source IP = destination IP**.
    
- Host receives a packet that appears to come **from itself**.
    
- Causes the host to enter a loop, replying to itself repeatedly or consuming resources.
    

**Example**

- Target: `192.168.10.1`
    
- Packet crafted: `SRC = 192.168.10.1`, `DST = 192.168.10.1`
    
- The system gets confused and may crash or freeze (older OSes especially vulnerable).
    

**Indicators**

- Traffic where source = destination.
    
- Repeated SYNs to same port from host’s own IP.
    

**Difference vs Others**

- Unlike Random Source, spoof is not varied — it’s exact same as victim.
    
- Unlike Smurf, no reflection needed — attack is direct self-DoS.
    

* * *

## 4\. Smurf Attack (Amplification/Reflection DoS)

**How it works**

- Attacker sends ICMP Echo Requests (pings) to many hosts in a subnet.
    
- Spoofs **source IP as victim’s IP**.
    
- All hosts reply to the victim, overwhelming it.
    
- Amplification factor = number of responding hosts.
    

**Example**

- Broadcast ICMP to `192.168.10.255` with **source = victim (192.168.10.1)**.
    
- All subnet hosts reply to `.1`.
    
- Victim drowns in ICMP Echo Replies.
    

**Indicators**

- Many ICMP replies to one host.
    
- Fragmented ICMP traffic with extra data (to increase size).
    
- Victim receiving traffic it never initiated.
    

**Difference vs Others**

- Uses **reflection/amplification** (third-party hosts used as “mirrors”).
    
- Different from Random Source/LAND where attacker talks directly to victim.
    

* * *

## 5\. Initialization Vector (IV) Generation (WEP Attack Context)

**How it works**

- Seen in **old Wi-Fi (WEP)** encryption.
    
- Attacker captures traffic, modifies packet source/destination, re-injects it.
    
- This forces AP/clients to generate new Initialization Vectors (IVs).
    
- More IVs collected → attacker cracks WEP via statistical analysis.
    

**Example**

- Attacker forges packet with new **source/dest IPs**.
    
- AP forwards it, generating new IV.
    
- Repeated thousands of times → attacker gets enough IVs to break encryption.
    

**Indicators**

- Excessive **repeated/replayed packets**.
    
- High traffic between AP and client with unusual duplication.
    

**Difference vs Others**

- Not a DoS — goal is **encryption cracking**.
    
- Unlike Smurf/LAND/Random Source, this attack is **wireless/WEP-specific**.
    

* * *

# Quick Comparison Table

| Attack | Goal | Source IP Spoofing Method | Target Impact | Difference |
| --- | --- | --- | --- | --- |
| **Decoy Scanning** | Recon (evade IDS/firewalls) | Pretends to be another trusted host | Confuses logs, partial evasion | Recon, not DoS |
| **Random Source DoS** | Exhaust victim service | Random fake IPs | Service slowdown/DoS | Victim gets traffic directly |
| **LAND Attack** | Self-inflicted DoS | Source = Destination | Host loops/locks up | Self-spoof, no third parties |
| **Smurf Attack** | Amplified DoS | Source = victim, sent to broadcast | Victim flooded by replies | Uses reflection/amplification |
| **IV Generation** | Crack WEP encryption | Source/Dest modified in replays | Weak key exposure | Wireless-only, not DoS |

&nbsp;

* * *

# Detection Techniques for IP Spoofing Attacks

## 1\. Decoy Scanning

**Variations**

- Single decoy IP (simple spoof).
    
- Multiple decoys (Nmap `-D` option).
    
- Fragmented packets to hide payload.
    

**Detection**

- **Connection consistency checks**:
    
    - Look for TCP handshakes where the initiator (SYN sender) differs from the host that continues the connection.
        
    - E.g., SYN from spoofed IP, but attacker’s real IP must later send ACKs for open ports.
        
- **Firewall/IDS state tracking**:
    
    - Compare “initiator IP” to “responder IP.” A mismatch is suspicious.
        
    - Stateful firewalls can flag half-open connections (SYN sent, no ACK returned from spoofed host).
        
- **Traffic anomaly detection**:
    
    - High volume of **SYNs from subnet IPs** that don’t normally scan.
        
    - Packets arriving from inside subnet but physically impossible routes (e.g., from WAN interface).
        
- **Fragmentation analysis**:
    
    - Unusual fragmentation in probe packets, often with tiny payloads.
        
    - IDS can flag abnormal fragmentation patterns that don’t match MTU constraints.
        

* * *

## 2\. Random Source DoS (Spoofed Floods)

**Variations**

- ICMP flood with random sources.
    
- TCP SYN flood with spoofed random sources.
    
- UDP floods with spoofed sources.
    
- Fragmented spoof floods.
    

**Detection**

- **Source distribution analysis**:
    
    - Legitimate traffic → small clusters of active clients.
        
    - Attack traffic → thousands of unique, never-before-seen IPs.
        
    - Use entropy analysis (measure randomness of source addresses).
        
- **Flow-level monitoring**:
    
    - Huge number of flows with **1–2 packets only** = spoofed floods.
        
    - Real users usually establish multi-packet flows.
        
- **Single-port focus**:
    
    - Random-source SYN floods often target **one port** (e.g., 80).
        
    - Detect “one port, many sources” patterns.
        
- **TTL / packet fingerprinting**:
    
    - Spoofed IPs often have inconsistent TTL, DF (don’t fragment) bits, or TCP window sizes.
        
    - Real devices in same region share similar fingerprints.
        
- **Incremental base ports**:
    
    - Many spoofing tools increment the source port sequentially.
        
    - Real clients randomize source ports.
        

* * *

## 3\. LAND Attack

**Variations**

- Classic LAND: **SRC = DST = victim**.
    
- Modified LAND: same IP, different ports (e.g., SRC port = DST port).
    

**Detection**

- **Packet sanity checks**:
    
    - Drop/alert if `SRC IP == DST IP` and `SRC port == DST port`.
        
    - Normal traffic should *never* have identical src/dst at both layers.
        
- **IDS rules**:
    
    - Snort/Suricata signatures for LAND are standard (`src_ip == dst_ip`).
- **State anomaly**:
    
    - Repeated SYNs “to self” with no external response.
        
    - Host repeatedly sees connections it supposedly initiated.
        
- **Volume analysis**:
    
    - LAND floods often spam the same tuple (IP+port).
        
    - Detect abnormal repetition rate on single socket.
        

* * *

## 4\. Smurf Attack

**Variations**

- Standard Smurf: ICMP echo request with victim as spoofed source, sent to broadcast.
    
- Fraggle Attack: UDP variant (e.g., spoofed UDP to port 7/echo or port 19/chargen).
    
- Amplified Smurf: Fragmented large ICMP requests for more bandwidth consumption.
    

**Detection**

- **ICMP request/reply imbalance**:
    
    - Victim receives **many ICMP replies** but never sent the original request.
        
    - IDS can detect asymmetry between echo requests vs echo replies.
        
- **Broadcast abuse monitoring**:
    
    - Flag ICMP requests sent to **directed broadcasts** (e.g., `192.168.1.255`).
        
    - Normal clients rarely ping broadcast addresses.
        
- **Amplification ratio analysis**:
    
    - Compare ratio of ICMP replies to ICMP requests seen in network.
        
    - High >1 ratio suggests Smurf reflection.
        
- **Traffic clustering**:
    
    - Multiple unrelated hosts sending ICMP replies to one victim.
        
    - Detection via NetFlow/sFlow collectors aggregating destination IPs.
        
- **Fragmentation anomalies**:
    
    - Look for fragmented ICMP packets carrying unusual payload size.
        
    - Legitimate pings are small and rarely fragmented.
        

* * *

## 5\. Initialization Vector (IV) Generation (WEP)

**Variations**

- Replay-based IV collection (forge packets with new src/dst).
    
- ARP replay attack (injects spoofed ARP requests).
    
- Fragmentation attack (split/rebuild packets to generate new IVs).
    

**Detection**

- **Excessive replay detection**:
    
    - Multiple identical packets seen repeatedly within short intervals.
        
    - Same payload/length but with unique IVs.
        
- **Unnatural traffic volume**:
    
    - Sudden spike in ARP requests or identical UDP frames from clients.
        
    - Especially suspicious in quiet WLANs.
        
- **Statistical anomaly in IV usage**:
    
    - Normal IV distribution = spread out.
        
    - Attack = bursts of new IVs in rapid succession.
        
- **Wireless IDS/WIPS monitoring**:
    
    - Look for repeated packets with forged MAC/IP headers.
        
    - Tools like Kismet, AirMagnet, or Aruba WIPS can detect replay loops.
        

* * *

# Summary Table

| Attack | Variation | Detection Techniques |
| --- | --- | --- |
| **Decoy Scanning** | Single decoy, multi-decoy, fragmented | Connection mismatch detection, stateful firewall checks, fragmentation analysis, anomaly-based IDS |
| **Random Source DoS** | ICMP/TCP/UDP floods, fragmented floods | Source entropy analysis, flow monitoring, TTL/fingerprint mismatches, single-port focus |
| **LAND Attack** | Classic (same IP+port), modified (same IP diff port) | Drop if src=dst, IDS signatures, socket repetition analysis |
| **Smurf Attack** | ICMP Smurf, Fraggle (UDP), Amplified/fragmented Smurf | ICMP imbalance, broadcast request detection, amplification ratio, clustered reply flows |
| **IV Generation (WEP)** | Replay-based, ARP replay, fragmentation | Replay detection, IV statistical analysis, WLAN IDS alerts, abnormal ARP volume |

* * *

&nbsp;