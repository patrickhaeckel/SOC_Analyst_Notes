---
title: 11. Security in Active Directory
updated: 2025-07-22 01:15:43Z
created: 2025-07-20 22:36:53Z
---

## üîê General Active Directory Hardening Measures

To protect an Active Directory (AD) environment from attacks, organizations must implement **layered security controls**‚Äînot just rely on a single tool. Below are several **key hardening strategies**:

* * *

### üõ°Ô∏è¬†**Microsoft LAPS (Local Administrator Password Solution)**

**Purpose**: Automatically manages the local administrator password on each Windows machine, helping prevent lateral movement.

- **How It Works**: LAPS sets a **unique, random password** for the built-in local admin account on each computer.
    
- **Rotation**: Passwords can be **rotated on a schedule**, like every 12 or 24 hours.
    
- **Storage**: The password is securely stored in **Active Directory** and accessible only to authorized users or systems.
    
- **Why It Helps**: Prevents attackers from using the same admin password across multiple hosts, which is a **common lateral movement technique**.
    

‚úÖ **Best Practice**: Use LAPS along with other tools‚Äîit‚Äôs effective but **not a complete solution by itself**.

* * *

### üîê Privilege Order (Most to Least)

| Rank | Group Name | Description |
| --- | --- | --- |
| 1Ô∏è‚É£ | **Domain Admins** | **Highest privileges** in the domain. Full control over all domain controllers, AD objects, group policies, users, computers, etc. |
| 2Ô∏è‚É£ | **Administrators** | Local admin group on **domain controllers and member computers**. Inherits privileges from Domain Admins if added. Has **full local machine control**. |
| 3Ô∏è‚É£ | **Backup Operators** | Can **bypass file permissions** to back up or restore files. Can log in locally to domain controllers and shut them down. Dangerous if abused. |
| 4Ô∏è‚É£ | **Account Operators** | Can **create, delete, and manage user accounts and groups** (excluding Admin accounts). Used for helpdesk-like tasks. Limited scope. |
| 5Ô∏è‚É£ | **Domain Users** | Default group for all users. **Minimal privileges**. Can log in, access shared resources if allowed, and change their own passwords. |

* * *

### üìä¬†**Audit Policy Settings (Logging and Monitoring)**

**Purpose**: Detect and alert on suspicious or unauthorized activity in the AD environment.

- **What to Monitor**:
    
    - Unauthorized account creation or deletion
        
    - Object changes (e.g., modifying group memberships)
        
    - Account lockouts or password changes
        
    - Remote logons and unusual login patterns
        
    - Tools or behaviors typical of attacks (e.g., password spraying, Kerberos attacks)
        
- **Benefits**:
    
    - Early detection of compromise
        
    - Helps with **incident response**
        
    - Provides data for **forensics and compliance**
        

‚úÖ **Best Practice**: Centralize logs using tools like **SIEM** (Security Information and Event Management) and enable **advanced audit policies**.

* * *

### üèõÔ∏è¬†**Group Policy Security Settings**

**Purpose**: Apply consistent security settings across all domain-joined systems.  
Group Policy Objects (GPOs) are **powerful tools** for managing Windows security at scale. Below are key categories and what they do:

#### üîë **Account Policies**

Affect how user accounts behave across the domain:

- **Password policies**: Minimum length, complexity, expiration
    
- **Account lockout settings**: Lock accounts after failed attempts
    
- **Kerberos policies**: Ticket lifetimes and renewal limits
    

* * *

#### üñ•Ô∏è **Local Policies**

Apply to individual computers:

- **Audit policy**: What events to log (e.g., logon attempts, privilege use)
    
- **User rights assignment**: Who can log in remotely, shut down the system, install drivers, etc.
    
- **Security options**: Disable guest accounts, rename admin accounts, block access to removable drives, etc.
    

* * *

#### üö´ **Software Restriction Policies**

Restrict what **types of software** can run:

- Define **trusted paths** or **blocked file types**
    
- Help prevent execution of malware or unauthorized tools
    

* * *

#### üö∑ **Application Control Policies (AppLocker)**

Control which applications **specific users or groups** can run:

- Block things like `.exe`, `.msi`, `.ps1`, `.vbs` files
    
- Prevent access to **PowerShell or CMD** for standard users
    
- Useful for enforcing **least privilege**
    

‚ö†Ô∏è **Note**: These controls can be bypassed by skilled attackers but still reduce risk as part of **defense-in-depth**.

* * *

#### üìã **Advanced Audit Policy Configuration**

Provides fine-grained control over:

- **File access or modification**
    
- **User logon/logoff activity**
    
- **Privilege usage**
    
- **Policy changes and system events**
    

‚úÖ **Best Practice**: Use this for **comprehensive auditing** and improved visibility into security-relevant events.

* * *

## üß†¬†**Active Directory Hardening**

| **Category** | **Measure** | **Purpose / Recommendation** | **Risk if Ignored** | **Benefit** |
| --- | --- | --- | --- | --- |
| **Credential Hygiene** | LAPS | Randomizes local admin passwords | Shared credentials, lateral movement | Prevents lateral movement between hosts |
|     | Group Managed Service Accounts | Use auto-managed, rotating service credentials | Password reuse, weak static passwords | Secures non-interactive service accounts |
|     | Password Hygiene & MFA | Use strong passphrases + enforce multi-factor authentication | Easily guessable or cracked passwords | Defends against brute-force and spraying attacks |
|     | Admin Account Separation | Separate daily-use and admin accounts + distinct passwords | Full domain compromise from user-level phishing | Limits attacker privilege escalation |
|     | Limit Domain Admin Usage | DA accounts should only log into Domain Controllers | DA credentials exposed on compromised hosts | Prevents credential theft from memory (e.g., LSASS dumps) |
| **Access Control** | Access Reviews | Regularly audit admin rights, group memberships, file access | Privilege creep, overprovisioned access | Enforces least privilege across the environment |
|     | Security Groups | Use groups to assign permissions, not individuals | Manual errors, access mismanagement | Simplifies and scales access management |
|     | Local Admin & RDP Control | Limit local admin + RDP rights using GPO and Restricted Groups | Credential theft, lateral movement | Reduces risk of host takeover and privilege escalation |
|     | Restricted Groups (via GPO) | Centrally control group memberships like Local Admins, DAs | Silent privilege escalation | Maintains strict control of critical group access |
| **Monitoring & Visibility** | Logging & Monitoring | Centralized event logging + alerting for suspicious activity | Missed attacks, lack of detection | Enables early warning and incident response |
|     | Advanced Audit Policies | Enable fine-grained logging (file access, policy changes, etc.) | Blind spots in user and system activity | Boosts forensic and compliance capabilities |
|     | Audit Policies & Logging | Detect AD enumeration, Kerberoasting, failed logins, etc. | Undetected attacks and enumeration activity | Identifies attacker behavior before compromise |
|     | Audit Stale AD Objects | Remove or disable unused/stale accounts and computers | Forgotten backdoor accounts with weak passwords | Reduces legacy attack surface |
| **System Configuration** | Patch Management (WSUS/SCCM) | Automate OS and app patching to close vulnerabilities | Unpatched systems exposed to exploits | Prevents compromise via known vulnerabilities |
|     | Group Policy (GPOs) | Centralized configuration and enforcement of security settings | Inconsistent endpoint security | Ensures consistent hardening across the domain |
|     | Software & App Restrictions | Use AppLocker or SRP to block unauthorized executables/scripts | Malware or attack tools may run freely | Shrinks the executable attack surface |
|     | Server Role Separation | Run each server role (DC, IIS, DB) on dedicated systems | Expanded attack surface, cross-service compromise | Limits blast radius of service exploitation |

* * *

## üõ†Ô∏è Advanced Active Directory Hardening Measures

Active Directory environments are common targets for attackers. The following hardening practices can significantly improve your security posture:

### üîÑ 1. **Patch Management (WSUS & SCCM)**

**Why it matters**: Unpatched systems are prime targets for exploitation.

- **WSUS (Windows Server Update Services)**: Free tool that automates patch distribution across Windows systems.
    
- **SCCM (System Center Configuration Manager)**: Paid solution that builds on WSUS with additional features like compliance reporting and device management.
    
- **Benefit**: Reduces manual patching and ensures **all systems receive critical updates**.
    
- **Risk of Manual Patching**: Time-consuming, error-prone, and often results in **missed systems**‚Äîleaving them vulnerable.
    

‚úÖ **Best Practice**: Automate patching with WSUS or SCCM to maximize coverage and minimize security gaps.

* * *

### üë§ 2. **Group Managed Service Accounts (gMSA)**

**Purpose**: Secure credentials for non-interactive services and scheduled tasks.

- Automatically managed **long (120-character) passwords** that rotate regularly.
    
- Can be used **across multiple systems**, making it ideal for services running on multiple servers.
    
- Users don't need to know the password.
    

‚úÖ **Benefit**: Eliminates password reuse and human error for service accounts.

* * *

### üë• 3. **Security Groups**

**Function**: Simplify access management across AD.

- Assign permissions to **groups** rather than individual users.
    
- Use for access to files, printers, applications, and system privileges.
    
- Includes **built-in groups** like `Domain Admins`, `Backup Operators`, `Account Operators`, etc.
    

‚úÖ **Benefit**: Centralized, scalable, and auditable permission management.

* * *

### üßç‚Äç‚ôÇÔ∏è 4. **Account Separation for Admins**

**Purpose**: Reduce the blast radius of a compromised workstation.

- Admins should have **two accounts**:
    
    - **User account** (e.g., `pato`) for daily tasks
        
    - **Admin account** (e.g., `pato_adm`) for privileged activities
        
- Admin accounts should only be used on **hardened admin workstations**.
    
- Use **different passwords** for each account to avoid reuse risk.
    

‚úÖ **Benefit**: Prevents a compromised user machine from exposing admin credentials.

* * *

### üîê 5. **Password Policies + Passphrases + 2FA**

**Modern password hygiene is essential**‚Äîtraditional complexity rules are not enough.

- Use **long passphrases** or **randomly generated passwords** (ideally 12+ characters).
    
- Avoid simple but "compliant" passwords like `Welcome1`.
    
- Implement **password filters** to block:
    
    - Seasons, months
        
    - Company name
        
    - Common words (e.g., "password", "admin", "welcome")
        
- Enforce **Multi-Factor Authentication (MFA)**‚Äîespecially for RDP and remote access.
    

‚úÖ **Benefit**: Significantly reduces risks from brute-force, spraying, and credential theft attacks.

* * *

### ‚õî 6. **Limit Domain Admin Usage**

**Domain Admins** should only log in to **Domain Controllers**, not:

- Workstations
    
- Web/application servers
    
- Jump hosts
    

**Why?**

- When Domain Admin credentials are used on a machine, **they are cached in memory** (e.g., LSASS), making them vulnerable to tools like Mimikatz.

‚úÖ **Best Practice**: Use **tiered admin accounts** and **Privileged Access Workstations (PAWs)**.

* * *

### üßπ 7. **Audit and Remove Stale AD Objects**

**Why?** Old accounts and computers are common entry points.

- Disable or delete:
    
    - **Unused user accounts**
        
    - **Obsolete service accounts**
        
    - **Inactive computer objects**
        
- Example: An old service account with a weak, unchanged password from years ago.
    

‚úÖ **Benefit**: Reduces attack surface and removes legacy risk.

* * *

### ‚úÖ 8.¬†**Auditing Permissions and Access**

**Why It Matters**: Over time, privileges tend to accumulate, often without justification. This increases risk if any one account is compromised.

- **Conduct periodic access reviews** to verify:
    
    - **Local administrator rights**
        
    - **Domain Admin and Enterprise Admin membership** (does anyone really need DA rights anymore?)
        
    - **File share and folder permissions**
        
    - **Security group memberships** (especially for privileged groups)
        
    - **Access to sensitive applications or resources**
        

‚úÖ **Goal**: Ensure **least privilege** is enforced‚Äîusers should only have access necessary for their role.

* * *

### üìã 9. **Audit Policies & Logging**

**Visibility is critical** for detecting threats and responding quickly.

- Enable **Windows Event Logging** across domain systems.
    
- Use **Security Information and Event Management (SIEM)** tools to:
    
    - Detect anomalies (e.g., excessive failed logins ‚Üí possible password spraying)
        
    - Identify early signs of attacks (e.g., **Kerberoasting**, **AD enumeration**)
        
- Review **Microsoft‚Äôs Audit Policy Recommendations** to log relevant security events.
    

‚úÖ **Tip**: Don‚Äôt just log **analyze**. Set alerts for high-risk behaviors.

* * *

### üë• 10.¬†**Using Restricted Groups via GPO**

**Purpose**: Centrally control who is a member of specific local or domain groups.

- Example uses:
    
    - Limit **Local Administrators group** to only authorized users (e.g., Domain Admins + helpdesk)
        
    - Restrict membership in **Enterprise Admins**, **Schema Admins**, or other privileged groups
        
- Done via **Group Policy ‚Üí Security Settings ‚Üí Restricted Groups**
    

‚úÖ **Benefit**: Prevents unauthorized users from being silently added to critical groups.

* * *

### üß± 11.¬†**Limiting Server Roles on Critical Systems**

**Why It Matters**: Each added role increases the **attack surface** of a server.

- **Never install unnecessary services** (e.g., IIS, SQL Server) on Domain Controllers.
    
- Keep **Exchange**, **web apps**, and **databases** on separate dedicated servers.
    
- Avoid combining roles like **DC + file server** or **DC + print server**.
    

‚úÖ **Best Practice**: Enforce **role separation** to limit the scope of compromise if one service is attacked.

* * *

### üîê 12.¬†**Limiting Local Admin and RDP Rights**

Too many organizations allow **Domain Users** to have local admin rights or Remote Desktop access across multiple machines‚Äîthis is extremely dangerous.

- **Risks**:
    
    - Any compromised low-privilege account could become **local admin** on a host.
        
    - If a privileged user logs into that host, an attacker could **harvest credentials from memory** (e.g., using Mimikatz).
        
- Use **Restricted Groups** or **Group Policy Preferences** to **strictly control**:
    
    - Who has **local admin** rights
        
    - Who can **RDP into each system**
        

‚úÖ **Goal**: Ensure **only those who absolutely need access** have it‚Äîespecially for RDP and local admin.