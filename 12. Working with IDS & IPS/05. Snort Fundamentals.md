---
title: 05. Snort Fundamentals
updated: 2025-09-26 00:36:28Z
created: 2025-09-22 03:23:49Z
---

# Snort Fundamentals

Snort is an **open-source network security tool** that can act as:

- **Packet Sniffer** – captures and views packets in real time.
    
- **Packet Logger** – stores packet data for later analysis.
    
- **Intrusion Detection System (IDS)** – monitors traffic for malicious patterns.
    
- **Intrusion Prevention System (IPS)** – actively blocks suspicious traffic.
    

Snort is rule-driven: it needs **rules** (signatures, conditions, actions) to know what to detect or block.

* * *

## Snort Operating Modes

Snort can run in several modes, depending on how you start it:

| Mode | Description | Command Example |
| --- | --- | --- |
| **Passive IDS** | Monitors traffic without blocking. Good for detection only. | `snort -i eth0` |
| **Inline IDS/IPS** | Intercepts and blocks traffic when rules are triggered. Requires DAQ support (`-Q`). | `snort -Q -i eth0` |
| **Packet Logger** | Logs raw packets to files for offline analysis. | `snort -l /var/log/snort` |
| **Pcap Reader** | Reads packets from a capture file for offline analysis. | `snort -r file.pcap` |

**Key point**: Passive = monitor only; Inline = block traffic.

* * *

## Snort Architecture

Snort isn’t just a sniffer—it has a modular pipeline:

1.  **Packet Decoder**
    
    - Captures raw packets from NIC or file.
        
    - Forwards them to preprocessors.
        
2.  **Preprocessors**
    
    - Normalize and analyze traffic before detection.
        
    - Examples:
        
        - `http_inspect` → normalizes HTTP.
            
        - `port_scan` → detects scanning behavior.
            
    - Configured in `snort.lua`
        
3.  **Detection Engine**
    
    - Compares packets against **Snort rules**.
        
    - If a rule matches → send to alerts/logging.
        
4.  **Logging & Alerting System**
    
    - Records or reports detections.
        
    - Output can be: syslog, database, unified2 binary logs, JSON, etc.
        
5.  **Output Modules**
    
    - Customize how/where alerts are stored or sent.

&nbsp;Think of Snort like an airport:

- Decoder = baggage scanner
    
- Preprocessors = customs officers checking details
    
- Detection Engine = match against watchlist
    
- Alerts/Outputs = alarms and reports
    

* * *

## Snort Configuration

Snort 3 uses **Lua-based configuration files**:

- **`snort.lua`** → Main config file (your starting point).
    
- **`snort_defaults.lua`** → Provides default values.
    

### Sections in `snort.lua`:

- Network variables
    
- Decoder config
    
- Detection engine config
    
- Preprocessors
    
- Output plugins
    
- Rule set loading
    

### Useful Commands:

- **List modules**:
    
- `snort --help-modules`
    
- **Check defaults for a module**:
    
- `snort --help-config arp_spoof`
    
- **Validate config**:
    
- `snort -c /etc/snort/snort.lua`
    

**Tip**: Empty `{}` in `snort.lua` means "use defaults".

* * *

## Snort Inputs

Snort can analyze traffic from two sources:

**Pcap file (offline analysis)**

- `snort -c /etc/snort/snort.lua -r file.pcap`

**Live interface (real-time analysis)**

- `snort -c /etc/snort/snort.lua -i eth0`

* * *

## Snort Rules

Rules = **heart of Snort detection**.

### Rule Structure:

`action protocol src_ip src_port -> dst_ip dst_port (options)`

- **Action**: alert, log, pass, drop, reject
    
- **Header**: defines traffic to inspect
    
- **Options**: define conditions (content match, flow, msg, etc.)
    

### Example Rule:

`alert icmp any any -> any any (msg:"ICMP test"; sid:1000001;)`

- Triggers alert on any ICMP packet.

### Rule Loading:

- Inside `snort.lua` with the `ips` module.
    
- From a **single file**:
    
- `snort -R local.rules`
    
- From a **directory of rules**:
    
- `snort --rule-path /etc/snort/rules/`
    

* * *

## Snort Outputs

Snort generates 3 main categories of output:

### 1\. **Statistics**

- Packet counts (TCP/UDP/ICMP)
    
- Module activity counts
    
- File type/size counts
    
- Runtime performance
    

### 2\. **Alerts**

Enable with `-A <type>`:

| Option | Description |
| --- | --- |
| `-A fast` | Minimal info (default). |
| `-A cmg` | Detailed (headers + payload). |
| `-A csv` | Output in CSV format. |
| `-A u2` | Unified2 binary logs (for SIEMs, Splunk, etc.). |

List available loggers:

`snort --list-plugins | grep logger`

### 3\. **Performance Monitoring**

- `perf_monitor` module → runtime counters
    
- `profiler` module → CPU/memory profiling
    

* * *

## Key Features of Snort

- Deep Packet Inspection (DPI)
    
- Intrusion Detection & Prevention
    
- Protocol/traffic anomaly detection
    
- Logging & monitoring capabilities
    
- Supports **IPv4 & IPv6**
    
- Multi-tenant support
    

* * *

## Snort Quick Commands

```
# Validate config
snort -c /etc/snort/snort.lua

# Run on live interface
snort -c /etc/snort/snort.lua -i eth0

# Run on pcap file
snort -c /etc/snort/snort.lua -r traffic.pcap

# Run inline (if DAQ supports)
snort -Q -c /etc/snort/snort.lua -i eth0

# Run with local rules
snort -c /etc/snort/snort.lua -R local.rules -A cmg

# Show available modules
snort --help-modules

# Show default config of a module
snort --help-config http_inspect

```

* * *

&nbsp;