---
title: 05. Dynamic Analysis
updated: 2025-10-28 04:25:10Z
created: 2025-10-17 22:16:32Z
---

# Dynamic Analysis (Improved Explanation)

Dynamic analysis, also known as **behavioral analysis**, focuses on **observing malware while it runs** in a controlled environment. Unlike static analysis, which inspects the code without execution, dynamic analysis lets us **see what the malware actually does** — the files it modifies, processes it spawns, and connections it attempts.

* * *

## 1\. Purpose and Concept

Dynamic analysis helps analysts:

- Understand **real-world malware behavior**.
    
- Identify **system changes**, persistence methods, and **network communications**.
    
- Detect **anti-analysis techniques**, such as sandbox or VM detection.
    

It’s performed in a **safe, isolated environment** (usually a virtual machine) that mimics a normal user system. This allows the malware to operate normally while the analyst monitors every move.

* * *

## 2\. Core Steps of Dynamic Analysis

**1\. Environment Setup**

- Create an **isolated VM** disconnected from the main network.
    
- Configure it with realistic user data, software, and a simulated internet connection (via tools like **INetSim** or **FakeNet-NG**).
    

**2\. Baseline Capture**

- Record the system’s “clean state” before execution — files, registry, running processes, and network config.
    
- This snapshot serves as a **reference point** to detect changes made by the malware later.
    

**3\. Tool Deployment (Pre-Execution)**

- Install monitoring tools:
    
    - **ProcMon** – logs process, file, and registry activity.
        
    - **Wireshark / tcpdump / Fiddler** – capture network traffic.
        
    - **Regshot** – compares registry changes before and after execution.
        
    - **INetSim / FakeDNS / FakeNet-NG** – simulate internet services.
        

**4\. Malware Execution**

- Run the malware inside the isolated environment.
    
- The monitoring tools record all activity in real time — file creation, registry keys, network traffic, and spawned processes.
    

**5\. Observation and Logging**

- Let the malware execute for enough time to reveal its behavior.
    
- Monitor system activity carefully and **log everything**.
    

**6\. Analysis of Collected Data**

- Stop the malware and all tools.
    
- Compare the post-execution system with the baseline.
    
- Identify **changes**, **connections**, and **suspicious patterns**.
    

* * *

## 3\. Using Sandboxes

Automated sandboxes like **Cuckoo Sandbox**, **Joe Sandbox**, or **FireEye DTI** can:

- Automatically run samples.
    
- Record behavior.
    
- Generate detailed reports on file, memory, and network activity.
    

However, **advanced malware** often includes sandbox-detection techniques to modify or suppress its actions when it detects such environments.

* * *

## 4\. Dynamic Analysis Example with Noriben

**Noriben** is a Python script that wraps **ProcMon** for convenience. It runs ProcMon, captures system events, filters irrelevant data, and produces readable reports for malware analysis.

**How Noriben Works:**

1.  **Setup:** Launch Noriben (`python .\Noriben.py`) and specify any runtime options (duration, sample path, filters).
    
2.  **ProcMon Launch:** Noriben starts ProcMon with a preconfigured filter set.
    
3.  **Sample Execution:** Run the malware (e.g., `shell.exe`). ProcMon records all activities.
    
4.  **Logging:** When finished, stop monitoring with `Ctrl+C`.
    
5.  **Report Generation:** Noriben produces a summary `.txt` report and a detailed `.csv` timeline.
    

Example output:

\[\*\] Saving report to: Noriben_27_Jul_23_\_23_42_335666.txt  
\[\*\] Saving timeline to: Noriben_27_Jul_23_\_23_42_335666_timeline.csv

This report highlights key behaviors like:

- New processes spawned.
    
- Files or registry entries modified.
    
- Network connections attempted.
    

* * *

## 5\. Limitations and Manual Analysis

Noriben filters normal system activity, but sometimes **filters out valuable clues**.  
For example, it may not show **how malware detects a virtual machine**.

To explore this:

1.  Launch **ProcMon** manually (`C:\Tools\sysinternals\procmon.exe`).
    
2.  Set filters manually (e.g., process name = `shell.exe` and operation = `RegQueryValue`).
    
3.  Observe registry queries — malware may check for **VMware registry keys** to detect sandbox environments.
    

* * *

## 6\. Summary

Dynamic analysis is about **observing malware in motion**.  
Through careful isolation, monitoring, and logging, analysts can:

- Reconstruct infection chains.
    
- Detect persistence mechanisms.
    
- Reveal command-and-control behaviors.
    
- Identify anti-analysis techniques.
    

While tools like **Noriben** simplify the process, deeper manual inspection using **ProcMon** and **Wireshark** provides **richer insights** into how malware truly behaves.

* * *

&nbsp;