---
title: 01. Windows Event Logs
updated: 2025-08-15 00:29:50Z
created: 2025-08-15 00:27:47Z
---

## **Windows Event Logs**¬†

### **1\. Purpose of Windows Event Logs**

Windows Event Logs record almost everything the OS and applications want to report ‚Äî errors, warnings, security events, performance data, and diagnostics.  
Sources include:

- **Windows core components** (kernel, system services)
    
- **Applications** (Office, browsers, etc.)
    
- **ETW providers** (low-level instrumentation)
    
- **Security services** (audit logs)
    

For cybersecurity, these logs are key to:

- Detecting intrusions
    
- Investigating incidents
    
- Correlating activity across systems
    

* * *

### **2\. Default Log Categories**

Accessible via **Event Viewer** or programmatically (Windows Event Log API, PowerShell, etc.).

| Log Name | Purpose |
| --- | --- |
| **Application** | App-related events (info, warnings, errors) |
| **Security** | Authentication, authorization, privilege changes |
| **Setup** | OS setup/installation logs |
| **System** | Core OS events (drivers, services, crashes) |
| **Forwarded Events** | Centralized logs from other machines |

üí° **Forwarded Events** are valuable for SOCs with a SIEM ‚Äî they enable centralized collection.

* * *

### **3\. Event Structure**

Each entry contains:

| Field | Description |
| --- | --- |
| **Log Name** | Which log the event is in |
| **Source** | App/component that generated the event |
| **Event ID** | Unique number for the event type |
| **Task Category** | Subclassification of the event |
| **Level** | Severity (Info, Warning, Error, Critical, Verbose) |
| **Keywords** | Broad tags (e.g., ‚ÄúAudit Success‚Äù) for filtering |
| **User** | Account linked to the event |
| **OpCode** | Operation being performed |
| **Logged** | Timestamp |
| **Computer** | Hostname |
| **XML Data** | Raw structured details |

* * *

### **4\. Example ‚Äì Security Event ID 4624 (Successful Logon)**

- **Meaning**: New logon session created
    
- **Important fields**:
    
    - *Logon ID*: Correlates with other events from same session
        
    - *Logon Type*: Explains how the login occurred (interactive, network, service, RDP, etc.)
        
- **Example use**: If Logon Type is `5` (Service), SYSTEM likely started a service. Investigate further.
    

* * *

### **5\. Correlation Using XML Queries**

**Why**: Cuts down noise and lets you track related actions.

**Example**: Filter all events with `SubjectLogonId=0x3E7` to follow a SYSTEM service session.

Steps in Event Viewer:  
`Filter Current Log` ‚Üí `XML` ‚Üí `Edit Query Manually` ‚Üí insert XML query.

This lets you:

- Find linked actions (e.g., privilege changes, object modifications)
    
- Rebuild a timeline of a session
    

* * *

### **6\. Example Investigation Flow**

1.  **Event 4907** ‚Äì SACL change (audit policy modification)
    
    - May indicate changes to logging/auditing settings for a file, registry key, etc.
        
    - Check `ProcessName` (e.g., `SetupHost.exe` ‚Äî could be legit or masquerading malware)
        
2.  **Event 4624** ‚Äì Logon
    
3.  **Event 4672** ‚Äì Special privileges assigned
    
    - Example: `SeDebugPrivilege` = Can access other processes‚Äô memory

Correlating these gives context:

- Setup process modified audit settings
    
- SYSTEM logged in
    
- Special privileges granted
    

* * *

### **7\. SOC Takeaways**

- **Forwarded Events** + **Logon ID correlation** = fast incident reconstruction
    
- Event IDs to know for authentication:
    
    - **4624** ‚Äì Successful logon
        
    - **4625** ‚Äì Failed logon
        
    - **4672** ‚Äì Special privileges assigned
        
- Always validate suspicious process names (malware often uses Windows-like names)
    
- XML filtering is powerful for large log datasets
    
- `.evtx` files can be analyzed offline for forensics
    

* * *

| Event ID | Category | Event Name | Description / Security Relevance |
| --- | --- | --- | --- |
| **1074** | System | System Shutdown/Restart | Logs when and why the system was shut down or restarted. Useful for detecting unexpected reboots (potential malware, unauthorized access). |
| **6005** | System | Event Log Service Started | Marks system boot-up. Good starting point for incident timeline and detecting unauthorized reboots. |
| **6006** | System | Event Log Service Stopped | Seen at shutdown. Unexpected occurrences may indicate attempts to hide activity. |
| **6013** | System | Windows Uptime | Shows daily uptime. Shorter than expected may suggest an unauthorized reboot. |
| **7040** | System | Service Status Change | Logs service startup type changes. Critical services altered may indicate tampering. |
| **1102** | Security | Audit Log Cleared | Often a sign of someone trying to erase evidence of intrusion. |
| **1116** | Security | Antivirus Malware Detection | Defender detects malware. Spikes may indicate targeted attacks or infections. |
| **1118** | Security | Antivirus Remediation Started | Defender began removing/quarantining malware. |
| **1119** | Security | Antivirus Remediation Succeeded | Threat successfully neutralized. |
| **1120** | Security | Antivirus Remediation Failed | Failed malware removal‚Äîrequires immediate response. |
| **4624** | Security | Successful Logon | Establishes normal user behavior. Odd logon times/locations may be malicious. |
| **4625** | Security | Failed Logon | Multiple failures may indicate brute-force attempts. |
| **4648** | Security | Logon Using Explicit Credentials | Can reveal lateral movement attempts. |
| **4656** | Security | Handle to Object Requested | Tracks access to files, registry keys, processes‚Äîcan spot sensitive resource access. |
| **4672** | Security | Special Privileges Assigned | Superuser logon‚Äîmonitor to prevent privilege abuse. |
| **4698** | Security | Scheduled Task Created | Attackers use scheduled tasks for persistence. |
| **4700 / 4701** | Security | Scheduled Task Enabled/Disabled | Changes to task status may indicate attacker manipulation. |
| **4702** | Security | Scheduled Task Updated | Altered tasks can signal malicious persistence. |
| **4719** | Security | Audit Policy Changed | Could be disabling logging to cover tracks. |
| **4738** | Security | User Account Changed | Unexpected changes to accounts may mean takeover or insider threat. |
| **4771** | Security | Kerberos Pre-authentication Failed | Excess failures could mean Kerberos brute-force. |
| **4776** | Security | DC Validated Credentials | Tracks credential validation attempts (success & failure). |
| **5001** | Security | AV Real-Time Protection Changed | Unauthorized changes can weaken defense. |
| **5140** | Security | Network Share Accessed | Monitors who accesses network shares. |
| **5142** | Security | Network Share Added | Unauthorized shares may be used for exfiltration or malware spread. |
| **5145** | Security | Network Share Access Check | Repeated checks may indicate mapping attempts. |
| **5157** | Security | Connection Blocked by WFP | Identifies potentially malicious blocked traffic. |
| **7045** | Security | Service Installed | Unknown new services may indicate malware installation. |