---
title: 02. Syntax
updated: 2025-08-24 06:37:44Z
created: 2025-08-21 23:23:01Z
---

# 1) Basic Searching

**Example:**

```
search index="main" "UNKNOWN"
```

### Breakdown:

- **`search`** → explicitly tells Splunk to run a search. Normally optional, because search is the default first command.
    
- **`index="main"`** → filter only events inside the **main index** (splunkdb bucket where data is stored).
    
- **`"UNKNOWN"`** → raw keyword search, case-insensitive. Splunk scans `_raw` (the event text) for this string.
    

### Example results:

- Matches an event like:
    
- ```
    08-21-2025 10:01:23 Error: UNKNOWN user login```  
    
    ```
    

* * *

**Example with wildcard:**

```
index="main" "*UNKNOWN*"
```

### Breakdown:

- **`*`** → wildcard matches zero or more characters.
    
- `"*UNKNOWN*"` → match any text containing UNKNOWN anywhere (prefix/suffix doesn’t matter).
    

* * *

# 2) Fields & Comparison Operators

**Example:**

```
index="main" EventCode!=1
```

### Breakdown:

- **`index="main"`** → search scope.
    
- **`EventCode!=1`** → comparison operator: “not equal to 1.”
    

* * *

Other operators:

- `=` → equals
    
- `!=` → not equals
    
- `<` → less than
    
- `>` → greater than
    
- `<=` / `>=` → less/greater than or equal
    

**Example:**

`index="main" EventCode>=5000`

→ Only events with EventCode 5000 or above.

* * *

# 3) fields

**Will reduce the paylod splunks carries**

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 | fields - User
```

### Breakdown:

- **`|`** → pipe operator, send results to next command.
    
- **`fields`** → field selection command.
    
- **`- User`** → remove the `User` field from the output.
    

* * *

**Variant:**

`... | fields _time, Image, CommandLine`

→ Keep only `_time`, `Image`, `CommandLine`. Everything else is dropped.

* * *

# 4) table

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 | table _time, host, Image
```

### Breakdown:

- **`table`** → formats search results into tabular format.
    
- **`_time`** → timestamp of the event.
    
- **`host`** → which machine generated it.
    
- **`Image`** → full path of the process.
    

Result = a clean table with only these 3 columns.

* * *

# 5) rename

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 | rename Image as Process
```

### Breakdown:

- **`rename`** → renames fields.
    
- **`Image`** → original field name.
    
- **`as Process`** → new field name.
    

Result = anywhere you would’ve seen `Image`, now it’s `Process`.

* * *

# 6) dedup

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 | dedup Image
```

### Breakdown:

- **`dedup`** → keep first unique record per field(s).
    
- **`Image`** → check uniqueness on the process image field.
    

So if `cmd.exe` appeared 20 times, you only get 1 row for it.

* * *

# 7) sort

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 | sort - _time
```

### Breakdown:

- **`sort`** → orders events.
    
- **`-`** → descending order.
    
- **`_time`** → sort based on event timestamp.
    

* * *

Variant:

`... | sort host, Image`

→ Sort by host first, then Image alphabetically.

* * *

# 8) stats

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=3 | stats count by _time, Image
```

### Breakdown:

- **`stats`** → aggregates results.
    
- **`count`** → count events.
    
- **`by _time, Image`** → group by each unique `_time + Image`.
    

Result = a table of (timestamp, process, count).

* * *

Other useful funcs:

- `dc(field)` = distinct count
    
- `values(field)` = set of values
    
- `max/min` = max/min number
    

* * *

# 9) chart

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=3 | chart count by _time, Image
```

### Breakdown:

- **`chart`** → pivot results into table-like chart.
    
- **`count`** → aggregate function.
    
- **`by _time, Image`** → rows = time, columns = process names.
    

So each process gets its own column across time.

* * *

# 10) eval

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 | eval Process_Path=lower(Image)
```

### Breakdown:

- **`eval`** → create/transform fields.
    
- **`Process_Path`** → new field.
    
- **`lower(Image)`** → make `Image` lowercase.
    

Result = `Process_Path` contains the lowercased version of the process path.

* * *

# 11) rex

**Example:**

```
index="main" EventCode=4662 | rex max_match=0 "[^%](?<guid>{.*})"| table guid
```

### Breakdown:

- **`rex`** → regex extractor.
    
- **`max_match=0`** → get all matches, not just the first.
    
- **`[^%]`** → match any char except `%` (avoid %GUID%).
    
- **`(?<guid>{.*})`** → capture into new field `guid` any text inside `{ }`.
    
- **`table guid`** → display just the GUIDs.
    

* * *

# 12) lookup

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 | rex field=Image "(?P<filename>[^\\\]+)$"
| eval filename=lower(filename)| lookup malware_lookup.csv filename OUTPUTNEW is_malware| table filename, is_malware
```

### Breakdown:

- **`rex field=Image ...`** → extract just filename from process path.
    
- **`eval filename=lower(filename)`** → normalize to lowercase.
    
- **`lookup malware_lookup.csv filename OUTPUTNEW is_malware`** → enrich with lookup file, append `is_malware` flag if filename matches.
    
- **`table filename, is_malware`** → final result = clean detection table.
    

* * *

# 13) inputlookup

**Example:**

```
| inputlookup malware_lookup.csv
```

### Breakdown:

- **`inputlookup`** → reads a lookup table directly.
    
- **`malware_lookup.csv`** → file name of lookup.
    

Result = contents of CSV appear as Splunk events. Useful for validating or combining.

* * *

# 14) Time range (earliest, latest)

**Example:**

```
index="main" earliest=-7d EventCode!=1
```

### Breakdown:

- **`earliest=-7d`** → from 7 days ago until now.
    
- **`latest=`** (optional) sets the upper bound.
    
- **`EventCode!=1`** → exclude process creation.
    

* * *

# 15) transaction

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" (EventCode=1 OR EventCode=3)
| transaction Image startswith=eval(EventCode=1) endswith=eval(EventCode=3) maxspan=1m| table Image
| dedup Image
```

### Breakdown:

- **`transaction Image`** → group events by `Image`.
    
- **`startswith=eval(EventCode=1)`** → start transaction when process is created.
    
- **`endswith=eval(EventCode=3)`** → end when same process makes network connection.
    
- **`maxspan=1m`** → both events must occur within 1 minute.
    
- **`table Image`** → show process names.
    
- **`dedup Image`** → remove duplicates.
    

* * *

# 16) Subsearches

**Example:**

```
index="main" sourcetype="WinEventLog:Sysmon" EventCode=1NOT [ search index="main" sourcetype="WinEventLog:Sysmon" EventCode=1 
| top limit=100 Image | fields Image]| table _time, Image, CommandLine, User, ComputerName
```

### Breakdown:

- **Main search** → all process creation events.
    
- **`NOT [ subsearch ]`** → exclude results from subsearch.
    
- **Subsearch:**
    
    - Search same logs.
        
    - **`top limit=100 Image`** → get 100 most common processes.
        
    - **`fields Image`** → return only process names.
        
- **Effect** → main query excludes the most common processes (keeps rare ones).
    
- **`table ...`** → final view with useful hunting fields.
    

* * *

&nbsp;