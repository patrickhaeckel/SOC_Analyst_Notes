---
title: 02. Berkeley Packet Filter Syntax
updated: 2025-09-06 05:04:28Z
created: 2025-09-06 05:00:41Z
---

<div class="joplin-table-wrapper">

## BPF Syntax

Many tools (tcpdump, Wireshark, tshark) use **Berkeley Packet Filter (BPF)** syntax. 

<table summary="" id="c_forensics_bpf__table_lpg_pwz_mfb" class="defaultstyle cds--data-table jop-noMdConv" style="width: 100%;"><thead class="jop-noMdConv"><tr class="jop-noMdConv"><th id="c_forensics_bpf__table_lpg_pwz_mfb__entry__1" class="jop-noMdConv" style="width: 32.6451%;"><div class="cds--table-header-label">Primitive filter</div></th><th id="c_forensics_bpf__table_lpg_pwz_mfb__entry__2" class="jop-noMdConv" style="width: 67.3549%;"><div class="cds--table-header-label">Description</div></th></tr></thead><tbody class="jop-noMdConv"><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">[src|dst] host &lt;host&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches a host as the IP source, destination, or either.<div class="p">The following list shows examples of host expressions:<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">dst host 192.168.1.0</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">src host 192.168.1</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">dst host 172.16</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">src host 10</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">host 192.168.1.0</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">host 192.168.1.0/24</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">src host 192.168.1/24</code></li></ul></div><p>The host expressions can be used with other protocols like <code class="ph codeph jop-noMdConv">ip</code>, <code class="ph codeph jop-noMdConv">arp</code>, <code class="ph codeph jop-noMdConv">rarp</code> or <code class="ph codeph jop-noMdConv">ip6</code>.</p></td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">ether [src|dst] host &lt;ehost&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches a host as the Ethernet source, destination, or either.<div class="p">The following list shows examples of host expressions:<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">ether host &lt;MAC&gt;</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">ether src host &lt;MAC&gt;</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">ether dst host &lt;MAC&gt;</code></li></ul></div></td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">[src|dst] net &lt;network&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches packets to or from the source and destination, or either.<div class="p">An IPv4 network number can be specified as:<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv">Dotted quad (for example, 192.168.1.0)</li><li class="cds--list__item jop-noMdConv">Dotted triple (for example, 192.168.1)</li><li class="cds--list__item jop-noMdConv">Dotted pair (for example, 172.16)</li><li class="cds--list__item jop-noMdConv">Single number (for example, 10)</li></ul></div><div class="p">The following list shows some examples:<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">dst net 192.168.1.0</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">src net 192.168.1</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">dst net 172.16</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">src net 10</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">net 192.168.1.0</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">net 192.168.1.0/24</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">src net 192.168.1/24</code></li></ul></div></td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">[src|dst] net &lt;network&gt; mask &lt;netmask&gt; or [src|dst] net &lt;network&gt;/&lt;len&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches packets with specific netmask.<div class="p">You can also use <code class="ph codeph jop-noMdConv">/len</code> to capture traffic from range of IP addresses.<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv">Netmask for dotted quad (for example, 192.168.1.0) is 255.255.255.255</li><li class="cds--list__item jop-noMdConv">Netmask for dotted triple (for example, 192.168.1) is 255.255.255.0</li><li class="cds--list__item jop-noMdConv">Netmask for dotted pair (for example, 172.16) is 255.255.0.0</li><li class="cds--list__item jop-noMdConv">Netmask for a single number (for example, 10) is 255.0.0.0</li></ul></div><div class="p">The following list shows some examples:<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">dst net 192.168.1.0 mask 255.255.255.255 or dst net 192.168.1.0/24</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">src net 192.168.1 mask 255.255.255.0 or src net 192.168.1/24</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">dst net 172.16 mask 255.255.0.0 src net 10 mask 255.0.0.0</code></li></ul></div></td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">[src|dst] port &lt;port&gt; or [tcp|udp] [src|dst] port &lt;port&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches packets that are sent to or from a port.<p>Protocols, such as TCP, UDP, and IP, can be applied to a port to get specific results.</p><div class="p">The following list shows some examples:<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">src port 443</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">dst port 20</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">port 80</code></li></ul></div></td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">[src|dst] portrange &lt;p1&gt;-&lt;p2&gt; or [tcp|udp] [src|dst] portrange &lt;p1&gt;-&lt;p2&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches packets to or from a port in a specific range.<p>Protocols can be applied to port range to filter specific packets within the range</p><div class="p">The following list shows some examples:<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">src portrange 80-88</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">tcp portrange 1501-1549</code></li></ul></div></td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">less &lt;length&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches packets less than or equal to length, for example, <code class="ph codeph jop-noMdConv">len &lt;= length</code>.</td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">greater &lt;length&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches packets greater than or equal to length, for example, <code class="ph codeph jop-noMdConv">len &gt;= length</code>.</td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">(ether|ip|ip6) proto &lt;protocol&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches an Ethernet, IPv4, or IPv6 protocol.<div class="p">The protocol can be a number or name, for example,<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">ether proto 0x888e</code></li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">ip proto 50</code></li></ul></div></td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">(ip|ip6) protochain &lt;protocol&gt;</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches IPv4, or IPv6 packets with a protocol header in the protocol header chain, for example <code class="ph codeph jop-noMdConv">ip6 protochain 6</code>.</td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">(ether|ip) broadcast</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches Ethernet or IPv4 broadcasts</td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">(ether|ip|ip6) multicast</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches Ethernet, IPv4, or IPv6 multicasts. For example, <code class="ph codeph jop-noMdConv">ether[0] &amp; 1 != 0</code>.</td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">vlan [&lt;vlan&gt;]</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches 802.1Q frames with a VLAN ID of <code class="ph codeph jop-noMdConv">vlan</code>.<div class="p">Here are some examples:<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">vlan 100 &amp;&amp; vlan 200</code> filters on vlan 200 encapsulated within vlan 100.</li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">vlan &amp;&amp; vlan 300 &amp;&amp; ip</code> filters IPv4 protocols encapsulated in vlan 300 encapsulated within any higher-order vlan.</li></ul></div></td></tr><tr class="jop-noMdConv"><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__1 " class="jop-noMdConv" style="width: 32.6451%;"><code class="ph codeph jop-noMdConv">mpls [&lt;label&gt;]</code></td><td headers="c_forensics_bpf__table_lpg_pwz_mfb__entry__2 " class="jop-noMdConv" style="width: 67.3549%;">Matches MPLS packets with a label.<p>The MPLS expression can be used more than once to filter on MPLS hierarchies.</p><div class="p">This list shows some examples:<ul class="cds--list--unordered jop-noMdConv"><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">mpls 100000 &amp;&amp; mpls 1024</code> filters packets with outer label 100000 and inner label 1024.</li><li class="cds--list__item jop-noMdConv"><code class="ph codeph jop-noMdConv">mpls &amp;&amp; mpls 1024 &amp;&amp; host 192.9.200.1</code> filters packets to and from 192.9.200.1 with an inner label of 1024 and any outer label.</li></ul></div></td></tr></tbody></table></div>

## Protocols and operators[](https://www.ibm.com/docs/en/qsip/7.4?topic=queries-berkeley-packet-filters#c_forensics_bpf__prot_operators__title__1 "Copy to clipboard")

You can build complex filter expressions by using modifiers and operators to combine protocols with primitive BPF filters.

The following list shows protocols that you can use:

- `arp`
- `ether`
- `fddi`
- `icmp`
- `ip`
- `ip6`
- `link`
- `ppp`
- `radio`
- `rarp`
- `slip`
- `tcp`
- `tr`
- `udp`
- `wlan`

Table 2. Valid modifiers and operators

| Description | Syntax |
| --- | --- |
| Parentheses | ( ) |
| Negation | !=  |
| Concatenation | '&&' or 'and' |
| Alteration | '\|' or 'or' |

## BPF filter examples[](https://www.ibm.com/docs/en/qsip/7.4?topic=queries-berkeley-packet-filters#c_forensics_bpf__bpf_examples__title__1 "Copy to clipboard")

The following table shows examples of BPF filters that use operators and modifiers:

Table 3. BPF filter examples

| BPF filter example | Description |
| --- | --- |
| `udp dst port not 53` | UDP not bound for port 53. |
| `host 10.0 .0.1 && host 10.0 .0.2` | Traffic between these hosts. |
| `tcp dst port 80 or 8080` | Packets to either of the specified TCP ports. |
| `ether[0:4] & 0xffffff0f > 25` | Range based mask that is applied to bytes greater than 25. |
| `ip[1] != 0` | Captures packets for which the `Types of Service` (TOS) field in the IP header is not equal to 0. |
| `ether host 11:22:33:44:55:66` | Matches a specific host with that Mac address. |
| `ether[0] & 1 = 0 and ip[16] >= 224` | Captures IP broadcast or multicast broadcast that were not sent via Ethernet broadcast or multicast. |
| `icmp[icmptype] != icmp-echo` | Captures all icmp packets that are not echo requests. |
| `ip[0] & 0xf !=5` | Captures all IP packets with options. |
| `ip[6:2] & 0x1fff = 0` | Captures only unfragmented IPv4 datagrams, and frag zero of fragmented IPv4 datagrams. |
| `tcp[13] & 16 != 0` | Captures TCP-ACK packets. |
| `tcp[13] & 32 !=0` | Captures TCP-URG packets. |
| `tcp[13] & 8!=0` | Captures TCP-PSH packets. |
| `tcp[13] & 4!=0` | Captures TCP-RST packets. |
| `TCP[13] & 2!=0` | Captures TCP-SYN packets. |
| `tcp[13] & 1!=0` | Captures TCP-FIN packets. |
| `tcp[tcpflags] & (tcp-syn\|tcp-fin) != 0` | Captures start and end packets (the SYN and FIN packets) of each TCP conversation. |